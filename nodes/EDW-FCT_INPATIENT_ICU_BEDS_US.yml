steps:
  FCT_INPATIENT_ICU_BEDS_US-91:
    operation:
      config:
        postSQL: ""
        preSQL: ""
        testsEnabled: true
      database: ""
      dependencies: []
      description: ""
      isDataVault: false
      isMultisource: false
      locationID: ""
      locationName: EDW
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 929
              stepCounter: "91"
            config: {}
            dataType: NUMBER
            defaultValue: ""
            description: ""
            hashColumns: []
            hashDetails: null
            isSurrogateKey: true
            name: DIM_DEMOGRAPHICS_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 894
                    stepCounter: "90"
                transform: ""
          - columnReference:
              columnCounter: 913
              stepCounter: "91"
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: Adult_ICU_BED_OCCUPIED
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 803
                    stepCounter: "83"
                transform: ""
          - columnReference:
              columnCounter: 916
              stepCounter: "91"
            dataType: FLOAT
            description: ""
            hashColumns: []
            hashDetails: null
            name: STAFFED_ADULT_ICU_BEDS_OCCUPIED_PCT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 806
                    stepCounter: "83"
                transform: ""
          - columnReference:
              columnCounter: 919
              stepCounter: "91"
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: TOTAL_STAFFED_ICU_BEDS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 809
                    stepCounter: "83"
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 927
              stepCounter: "91"
            config: {}
            dataType: NUMBER(38 , 0)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: ADULT_ICU_VACANT_BED
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: total_staffed_ICU_BEDS-STAFFED_ADULT_ICU_BEDS_OCCUPIED
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 928
              stepCounter: "91"
            config: {}
            dataType: FLOAT
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: ADULT_ICU_VACANT_BED_PCT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0
                    stepCounter: "0"
                transform: (STAFFED_ADULT_ICU_BEDS_OCCUPIED/total_staffed_ICU_BEDS)*100
            systemColumnType: None
            transform: ""
          - columnReference:
              columnCounter: 912
              stepCounter: "91"
            dataType: TIMESTAMP_NTZ(9)
            description: ""
            hashColumns: []
            hashDetails: null
            name: DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 802
                    stepCounter: "83"
                transform: ""
          - columnReference:
              columnCounter: 924
              stepCounter: "91"
            dataType: BOOLEAN
            description: ""
            hashColumns: []
            hashDetails: null
            name: LAST_REPORTED_FLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 814
                    stepCounter: "83"
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 925
              stepCounter: "91"
            config: {}
            dataType: TIMESTAMP
            defaultValue: ""
            description: ""
            hashColumns: []
            isSystemCreateDate: true
            name: SYSTEM_CREATE_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: CAST(CURRENT_TIMESTAMP AS TIMESTAMP)
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 926
              stepCounter: "91"
            config: {}
            dataType: TIMESTAMP
            defaultValue: ""
            description: ""
            hashColumns: []
            isSystemUpdateDate: true
            name: SYSTEM_UPDATE_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: CAST(CURRENT_TIMESTAMP AS TIMESTAMP)
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 977
              stepCounter: "91"
            config: {}
            dataType: NUMBER
            defaultValue: ""
            description: ""
            hashColumns: []
            hashDetails: null
            isSurrogateKey: true
            name: DIM_DEMOGRAPHICS_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 894
                    stepCounter: "90"
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              DIM_Geography: "90"
              STG_INPATIENT_ICU_BEDS_US: "83"
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: STAGE
                nodeName: STG_INPATIENT_ICU_BEDS_US
              - locationName: EDW
                nodeName: DIM_Geography
            join:
              joinCondition: >-
                FROM {{ ref('STAGE', 'STG_INPATIENT_ICU_BEDS_US') }}
                "STG_INPATIENT_ICU_BEDS_US"

                LEFT JOIN {{ ref('EDW', 'DIM_Geography') }} "DIM_Geography"

                ON "STG_INPATIENT_ICU_BEDS_US"."ISO3166_1" = "DIM_Geography"."country_code"

                AND "STG_INPATIENT_ICU_BEDS_US"."STATE" = "DIM_Geography"."state_code"
            name: FCT_INPATIENT_ICU_BEDS_US
            noLinkRefs: []
      name: FCT_INPATIENT_ICU_BEDS_US
      overrideSQL: false
      schema: ""
      sqlType: Fact
      type: sql
    stepCounter: "91"
